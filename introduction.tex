\section{序論}

\emph{計算可能解析学} (Computable Analysis) \cite{weihrauch00:_comput_analy} では
計算可能性理論や計算量理論の視点から解析学を扱う. 
「計算可能な実数」や「多項式時間計算可能な実関数」といった概念を定義し
(本稿では\ref{section: preliminaries}節で説明する), 
解析学に現れる様々な実数や実関数の本質的な難しさを分析する. 

連続実関数 $g \colon [0,1] \times \R \to \R$ に対して次の常微分方程式を考える. 
\begin{align}
 \label{eq:ode}
 h(0) & = 0, &
 \D h(t) & = g(t,h(t)) \quad (t \in [0,1])
\end{align}
ただし $\D h$ は $h$ の導関数.
本稿では $g$ が多項式時間計算可能であるとき, 
解 $h$ がどれほど複雑でありうるかを考える.

$g$ に多項式時間計算可能であることの他に何の制限も設けない場合, 
解 $h$ (一般に一意でない) は計算不能でありうるため,
様々な制限のもと $h$ の計算量が研究されている (表 \ref{table:related}).
この表では下に向うにつれて左列の条件が強まっている. 
Lipschitz 条件とは解 $h$ が一意であるための十分条件であり, 
これが満たされるときには, 解 $h$ は多項式領域計算可能であり, 
$\classPSPACE$ 困難でありうることがわかっている. 
つまり上界と下界が一致しているといえる (詳しくは河村 \cite{kawamura2010lipschitz}).
一方で $g$ が解析的であるとき, 解 $h$ も解析的となり, 
このとき $h$ は多項式時間計算可能である.


\begin{table}
\renewcommand\arraystretch{1.3}
\begin{center}
 \caption{多項式時間計算可能実関数 $g$ の常微分方程式 (\ref{eq:ode}) の解 $h$ の計算量}
 \label{table:related}
 \begin{tabular}{lll}
  制限 & 上界 & 下界 \\
  \hline
   --- & --- & 計算不可能たりうる \cite{pour1979computable} \\
  $h$ が $g$ の唯一解 & 計算可能 \cite{coddington1955theory}
  & 任意の時間がかかりうる \cite{ko1983computational, miller1970recursive} \\
  $g$ が Lipschitz 条件を満たす & 多項式領域計算可能 \cite{ko1983computational}
      &	$\classPSPACE$ 困難になりうる \cite{kawamura2010lipschitz}\\
  $g$ が $(\infty, 1)$ 回連続微分可能 & 多項式領域計算可能 & \parbox[t]{14zw}{$\classPSPACE$ 困難になりうる\\{}[本稿定理\ref{DifferentiableIsPspace}]} \\
  $g$ が $(\infty, k)$ 回連続微分可能 & 多項式領域計算可能 & \parbox[t]{14zw}{$\classCH$ 困難たりうる\\{}[本稿定理\ref{KTimesIsCH}]} \\
  $g$ が解析的 
  & 多項式時間計算可能 \cite{ko1988computing, kawamura2010complexity} 
  & ---
 \end{tabular}
\end{center}
\end{table}

そこで本稿ではこの隔たりを埋めるため, 滑らか
つまり微分可能な実関数 $g$ について $h$ の計算量がどれほどになりうるかを調べた.


問題を数値的に解くとき, 一般に与えられる関数が滑らか
であれば良い精度の解を求めることや, 高速に解くことは容易である.
解析的な関数の場合テイラー展開を用いることで, さらに良い精度で高速に求めることができる.
しかしその容易性が, 本質的つまり計算量的に意味のあるものなのか, 調べてみたいというのが,
本研究の動機である.

例えば, 積分の計算量については
無限回微分可能な関数の積分も一般の関数の積分と同等に多項式領域困難であるが,
解析的な関数の積分においては, 多項式時間計算可能である.
つまり無限回微分可能と解析的という制限の間に大きな隔たりをもつ.
最大化でも同様に, 無限回微分可能な関数の最大化は一般の関数の最大化と同じく
$\classNP$ 困難であるが,
解析的な関数の最大化は多項式時間計算可能である.


無限回微分可能な関数の最大化が一般の関数と同じく$\classNP$困難であること
の証明は葛によって与えられているが, その中には間違いが存在する.
その訂正をするなかで, 同じ手法を常微分方程式にも用いることができないかと考えた.

二変数実関数 $g$ が $(i, j)$ 回連続微分可能であるとは,
第一変数について $i$ 回, 第二変数について $j$ 回微分でき, 
その導関数が連続であることとする
(\ref{section: preliminaries}節で厳密に定義).

 \begin{theorem}
  \label{DifferentiableIsPspace}
  多項式時間計算可能かつ $(\infty, 1)$ 回連続微分可能な
  実関数 $g \colon [0,1] \times [-1,1] \to \R$ であって, 
  常微分方程式\eqref{eq:ode}が
  $\classPSPACE$ 困難な解 $h \colon [0, 1] \to \R$ を持つものが存在する.
 \end{theorem}

 \begin{theorem}
  \label{KTimesIsCH}
  任意の自然数 $k \ge 2$ に対して, 
  多項式時間計算可能かつ $(\infty, k)$ 回連続微分可能な
  実関数 $g \colon [0,1] \times [-1,1] \to \R$ であって, 
  常微分方程式(\ref{eq:ode})が
  $\classCH$ 困難な解 $h \colon [0, 1] \to \R$ を持つものが存在する.
 \end{theorem}

ここで $g \colon [0,1] \times \R \to \R$ でなく
$g \colon [0,1] \times [-1, 1] \to \R$ と書いたのは, 
本稿では実関数の多項式時間計算可能性を, 
定義域が有界閉領域のときにのみ定義するからである. 
このため $h$ が区間 $[-1, 1]$ の外に値を取ることがあると
方程式(\ref{eq:ode})が意味をなさなくなるが, 
定理\ref{DifferentiableIsPspace}において $h$ が解であるというのは, 
任意の $t \in [0, 1]$ について $h (t) \in [-1, 1]$ が満たされることも含めて述べている.
なお両定理とも Lipschitz 条件よりも強い仮定を置いているため, 
そのような $h$ は $g$ に対して, 存在すれば唯一である. 

また二変数関数 $g$ が
$i+j \le k$ を満たす任意の自然数 $i,j$ について
$(i,j)$ 回連続微分可能であることを, 
$g$ が $k$ 回連続微可能であると言うこともある.
定理\ref{DifferentiableIsPspace}で主張される $g$ は, 
$(\infty, 1)$ 回連続微分可能であるから, 
特に $1$ 回連続微分可能である. 


１回微分可能な実関数においては, より弱い条件であるLipschitz条件を満たすときと同じく,
$\classPSPACE$困難であることを示すことができた.
しかし2回以上微分可能な実関数の常微分方程式においては,
$\classPSPACE$に含まれる計算量クラスである$\classCH$に対して困難であること
のみ示された.

$\classCH$は定数回の計数(数え上げ)による計算量クラスである.
積分が $\#\classP$困難であるように,
離散的な計数が実関数では積分に対応する.
常微分方程式は $h(t)$ にたいして
これは１回微分可能という条件のもとでは
入力に対して十分にフィードバックをかけることが可能だったが,
2回微分可能のという制限によってフィードバックが



 また定理 \ref{KTimesIsCH} において
 任意の $k$ に対して $(\infty, k)$ 階微分可能な関数を考えているが,
 一つの関数が任意の $k$ に対して $k$ 階微分であることを求めているわけではない.
 つまり $g$ が無限回微分可能であると制限しているわけではない. 
 無限回微分可能な関数に対する常微分方程式の計算量は今後の課題である.


\subsection{演算子の計算量}

定理\ref{DifferentiableIsPspace}, 
\ref{KTimesIsCH}はいづれも
関数$g$を多項式時間計算可能と仮定した上で
解$h$の計算量について述べている. 
しかし微分方程式を「解く」困難さ, 
すなわち与えられた$g$から$h$を求める演算子の計算量は
如何程であろうか. 
この問に答えるには先ず
実関数を実関数へ写す演算子の計算量を
定義することを要する. 
実数の名を実数の名へ変換する機械を以て実関数の計算を定義したのと同じように, 
実関数の名を実関数の名へ変換することになる. 
ほげほげ……

\newcommand{\OpDiffIVP}{\mathit{ODE}}
\newcommand{\deltabox}{\delta _\square}
\newcommand{\classtwofont}[1]{\text{\bfseries \sffamily \upshape #1}}
\newcommand{\classFPSPACEtwo}{\classtwofont{FPSPACE}}
\newcommand{\classCHtwo}{\classtwofont{CH}}
\newcommand{\redW}{\leq _{\mathrm W}}
\newcommand{\redSW}{\leq _{\mathrm{sW}}}

\begin{theorem}
$\OpDiffIVP _1$は$(\deltabox, \deltabox)$-$\classFPSPACEtwo$-$\redW$完全. 
\end{theorem}

\begin{theorem}
$\OpDiffIVP _k$は$(\deltabox, \deltabox)$-$\classFPSPACEtwo$に属し, 
$(\deltabox, \deltabox)$-$\classCHtwo$-$\redW$困難. 
\end{theorem}

\begin{theorem}
$\OpDiffIVP _\infty$は$\classFPSPACEtwo$-$\redSW$完全. 
\end{theorem}

